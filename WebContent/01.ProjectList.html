<!DOCTYPE html>
<html>
<head>
<title>Production List</title>
<link rel="stylesheet" type="text/css" href="css/jmscms.css" />
<link rel="stylesheet" type="text/css" href="js/jquery-ui.css" />

<script type="text/javascript" src="js/jquery-3.3.1.js"></script>
<script type="text/javascript" src="js/jsviews.js"></script>  
<script type="text/javascript" src="js/jquery-ui.js"></script>
<script type="text/javascript" src="js/jquery.tablesorter.js"></script>
<style>
.warning{
  color: red;
}
</style>
</head>
<body>
  <div id="common">
  include common.html here
  </div>
  
  <div class="right_section">
    <!-- Here is name of the list -->
    <div class="toolbar">
      <div class="tab">
        <button class="tablinks" onclick="">Project Status</button>
      </div>
    </div>
    <div class="nemubar">
      <!-- Here is position of nemu bar -->
      <ul>
      <!-- 
        <li><a class="selecttab" href="02.ProjectDetail.html?NewProject=true">New Project</a></li>
      -->
        <li><a class="selecttab" href="99.ProjectUpdate.html?NewProject=true">New Project</a></li>
        <li><a href="#Filter">Filter</a></li>
      </ul>
    </div>
    <div id="list_section">
      <!-- Here is the list -->
      <div id="projects_div"></div>
    </div>
  </div>
</body>
<script id="myHoursTmpl" type="text/x-jsrender">  
      <table class="list_table" id="tbl">
        <thead>
          <tr>
            <th width="8%">Client</th>
            <th width="20%">Project Name</th>
            <th width="10%">Start Date</th>
            <th width="10%">Last Update Date</th>
            <th width="30%">Assigned To</th>
            <th width="8%">Estimated Hours</th>
            <th width="10%">Total Worked Hours</th>
            <th width="10%">Remain Hours</th>
            <th width="8%">Progress</th>
          </tr>
        </thead>
        <tbody>
{{for p}} 
          <tr>
            <td>{{:Client}}</td>
            <td style="text-align: left;"><a href="99.ProjectUpdate.html">{{:CategoryCriteria}}</a></td>
            <td>{{:StartDate}}</td>
            <td>{{:LastUpdate}}</td>
            <td style="text-align: left;"><a href="#">{{:AssignedTo}}</a></td>
            <td>{{:estimate}}</td>
            <td>{{:TotalWorkedHours}}</td>
            <td class="remaintd">{{:remain}}</td>
            <td class="progresstd">{{:progress}} %</td>
          </tr>
{{/for}} 
        </tbody> 
    </table>
</script>
<script >
function loadProjects(){
  var myTemplate = $.templates("#myHoursTmpl");  
  $.getJSON( "json/Projects.json", function( data ) {
	  var filterDate = [];
	  $.each(data, function(index, value){
		  value['estimate'] = 200;
		  value['remain'] = 200 - value['TotalWorkedHours'];
		  value['progress'] = Math.round(value['TotalWorkedHours'] / 200 * 100);
		  filterDate.push(value);
	  });
    var app = {p: filterDate };  
    myTemplate.link("#projects_div", app);
    $(".remaintd").each(function() {
    	var t = $( this ).html();
    	if (t.startsWith("-")){
    	  $( this ).addClass( "warning" );
    	  $( this ).next().addClass( "warning" );
    	}
    });
    $(".list_table").tablesorter();
    });
}

$(document).ready(function() {
    $("#common").load("00.common.html");
    
    loadProjects();
  });
</script>
</html>
