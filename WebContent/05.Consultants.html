<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="css/jmscms.css" />
<link rel="stylesheet" type="text/css" href="js/jquery-ui.css" />

<script type="text/javascript" src="js/jquery-3.3.1.js"></script>
<script type="text/javascript" src="js/jsviews.js"></script>  
<script type="text/javascript" src="js/jquery-ui.js"></script>
<script type="text/javascript" src="js/jquery.tablesorter.js"></script>
<script type="text/javascript" src="js/jms_cms_2018.js"></script>
<title>JMS Report Management System</title>

</head>
<body>
  <div id="common">
  include common.html here
  </div>
  
  <div class="right_section">
    <!-- Here is name of the list -->
    <div class="toolbar">
      <div class="tab">
        <button class="tablinks" onclick="">Consultants Status</button>
      </div>
    </div>
    <div class="nemubar">
      <!-- Here is position of nemu bar -->
      <ul>
        <li><a class="active" href="#home" onclick="showRegisterWindow()">New Consultant</a></li>
        <li><a href="#filter">Filter</a></li>
      </ul>
    </div>
    <div id="list_section">
      <!-- Here is the list -->
      <div id="consultants_div"></div>
    </div>
  </div>
  <div id="assignToWindow" class="modalwindow" title="Assign to">
      <form method="post" id="form2">
      <ul>
        <li><input type="checkbox" id="myself" value="1" /> Project 1 </li>
        <li><input type="checkbox" id="myself" value="2" /> Project 2 </li>
        <li><input type="checkbox" id="myself" value="3" />  Project 3 </li>
        <li><input type="checkbox" id="myself" value="4" checked/>  Project 4 </li>
        <li><input type="checkbox" id="myself" value="5" checked/>  Project 5 </li>
        <li><input type="checkbox" id="myself" value="6" checked/>  Project 6 </li>
      </ul>
        <p align="center"><input class="botton999" type="button"
            value="Save" onclick="assignToWindowSave()" /></p>
      </form>
  </div>
</body>
<script id="consultantsTmpl" type="text/x-jsrender">  
      <table class="list_table" id="tbl">
        <thead>
          <tr>
            <th width="10%">Name</th>
            <th width="6%">Joined JMS</th>
            <th width="8%">Speciality</th>
            <th width="6%">Rate</th>
            <th width="25%">Assigned Project</th>
  			<th width="8%">Acceptable Work Hours/W</th>
            <th width="6%">1 week AWH</th>
            <th width="6%">2 week AWH</th>
            <th width="6%">4 week AWH</th>
            <th width="10%">Projects Remain Hours</th>
            <th width="10%">Last Payment</th>
            <th width="10%">Unpaid Hours</th>
          </tr>
        </thead>
        <tbody>
{{for p}} 
          <tr>
            <td>{{:WorkedBy}}</td>
            <td>01/01/2017</td>
            <td>Plan Build</td>
            <td>100.00</td>
            <td style="text-align: left;">
{{for Projects}}
{{:#data}}<br/>
{{/for}} 
</td>
            <td>20.00</td>
			<td>22.50</td>
            <td>25.00</td>
            <td>16.75</td>
            <td>70.75</td>
            <td>05/01/2018</td>
            <td>13.25</td>
          </tr>
{{/for}} 
        </tbody> 
    </table>
</script>
<script type="text/javascript">
function assignToWindow(){
  console.log($( "#assigned" ).is('[readonly]'));
  if($( "#assigned" ).is('[readonly]')) {
    return;
  }
  $( "#assignToWindow" ).dialog({
        height: 300,
        width: 200,
        modal: true,
        resizable:false
   });
}

function assignToWindowSave(){
  $( "#assignToWindow" ).dialog("close");
}

function loadConcultants(){
  var myTemplate = $.templates("#consultantsTmpl");  
  $.getJSON( "json/Consultants.json", function( data ) {
    var filterDate = [];
    var c = {};
    var projects = [];
    var lastConsultant = "";
    var lastClient = "";
    $.each(data, function(index, value){
      if(value['WorkedBy'] != ""){
        if (lastConsultant != ""){
          c["Projects"] = projects;
          filterDate.push(c);
          c = {};
          projects = [];
        }
        lastConsultant = value['WorkedBy'];
        c['WorkedBy'] = lastConsultant;
        projects = [];
      }
      if(value['Client'] != ""){
        lastClient = value['Client'];
      }
      var project = lastClient + " / " + value['CategoryCriteria'] + " / " + value['TotalHours'];
      console.log(project);
      projects.push(project);
    });
    var app = {p: filterDate };  
    myTemplate.link("#consultants_div", app);
    $(".list_table").tablesorter();
    });
}

$(document).ready(function() {
    $("#common").load("00.common.html");
    loadConcultants();
  });
</script>
</html>
